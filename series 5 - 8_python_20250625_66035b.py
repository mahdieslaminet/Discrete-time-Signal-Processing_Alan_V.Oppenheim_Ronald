import nbformat as nbf
from nbformat.v4 import new_markdown_cell, new_notebook

# ایجاد نوت‌بوک جدید
nb = new_notebook()

# افزودن عنوان اصلی
nb.cells.append(new_markdown_cell("""
# سوالات و پاسخ‌های پیشرفته مخابراتی
**سری 5 تا 8 - مسائل ترکیبی و چالشی**
"""))

# سری 5
nb.cells.append(new_markdown_cell("## سری 5: مسائل محاسباتی AM/FM"))

# سوال 5-1
nb.cells.append(new_markdown_cell("""
### سوال 1: تحلیل سیگنال AM
سیگنال AM با معادله زیر داده شده است. حداکثر و حداقل دامنه پوش سیگنال و ضریب مدولاسیون را محاسبه کنید:
\\[
s(t) = 20[1 + 0.7 \\cos(2\\pi 800 t)]\\cos(2\\pi 10^6 t)
\\]

**پاسخ:**  
- حداکثر دامنه پوش: \\(20(1+0.7) = 34\\)  
- حداقل دامنه پوش: \\(20(1-0.7) = 6\\)  
- ضریب مدولاسیون: \\(0.7\\)
"""))

# سوال 5-2
nb.cells.append(new_markdown_cell("""
### سوال 2: محاسبات سیستم FM
در یک سیستم FM، اگر انحراف فرکانسی 75 kHz و فرکانس پیام 15 kHz باشد، شاخص مدولاسیون و پهنای باند کارسون را محاسبه کنید.

**پاسخ:**  
- شاخص مدولاسیون: \\(\\beta = \\frac{75}{15} = 5\\)  
- پهنای باند: \\(BW = 2(75 + 15) = 180 \\text{ kHz}\\)
"""))

# سوال 5-3
nb.cells.append(new_markdown_cell("""
### سوال 3: استخراج پارامترهای DSB-SC
سیگنال DSB-SC با معادله زیر داده شده است. فرکانس حامل و سیگنال پیام را استخراج کنید:
\\[
s(t) = 8\\cos(2\\pi 1.2 \\times 10^6 t) + 8\\cos(2\\pi 0.8 \\times 10^6 t)
\\]

**پاسخ:**  
- فرکانس حامل: \\(1 \\text{ MHz}\\)  
- سیگنال پیام: \\(m(t) = 8\\cos(2\\pi 0.2 \\times 10^6 t)\\)
"""))

# سوال 5-4
nb.cells.append(new_markdown_cell("""
### سوال 4: محاسبه توان در AM
توان کل یک سیگنال AM 100 وات است. اگر ضریب مدولاسیون 0.8 باشد، توان حامل و توان هر باند جانبی چقدر است؟

**پاسخ:**  
- توان حامل: \\(P_c = \\frac{100}{1 + 0.8^2/2} \\approx 86.96 \\text{ وات}\\)  
- توان هر باند جانبی: \\(P_{USB} = P_{LSB} = \\frac{0.8^2}{4} \\times 86.96 \\approx 13.91 \\text{ وات}\\)
"""))

# سوال 5-5
nb.cells.append(new_markdown_cell("""
### سوال 5: طراحی سیستم FM
در مدولاسیون FM، اگر حساسیت فرکانسی \\(k_f = 20 \\text{ kHz/V}\\) و سیگنال پیام \\(m(t) = 2\\cos(2\\pi 1 \\text{ kHz} t)\\) باشد، انحراف فرکانسی و پهنای باند را محاسبه کنید.

**پاسخ:**  
- انحراف فرکانسی: \\(\\Delta f = 20 \\times 2 = 40 \\text{ kHz}\\)  
- پهنای باند: \\(BW = 2(40 + 1) = 82 \\text{ kHz}\\)
"""))

# سری 6
nb.cells.append(new_markdown_cell("## سری 6: سیستم‌های دیجیتال"))

# سوال 6-1
nb.cells.append(new_markdown_cell("""
### سوال 1: محاسبات 16-PSK
در سیستم 16-PSK با نرخ سمبل 1 مگا سمبل بر ثانیه، نرخ داده و حداقل پهنای باند چقدر است؟

**پاسخ:**  
- نرخ داده: \\(R_b = 1 \\times \\log_2(16) = 4 \\text{ Mbps}\\)  
- پهنای باند: \\(BW = 1 \\text{ MHz}\\)
"""))

# سوال 6-2
nb.cells.append(new_markdown_cell("""
### سوال 2: محاسبه خطا در QAM
اگر در مدولاسیون 64-QAM نرخ خطای سمبل \\(10^{-5}\\) باشد و نرخ سمبل 500 کیلو سمبل بر ثانیه، چند بیت در ثانیه به اشتباه دریافت می‌شود؟

**پاسخ:**  
- بیت‌های اشتباه: \\(10^{-5} \\times 500 \\times 10^3 \\times 6 = 30 \\text{ بیت/ثانیه}\\)
"""))

# سوال 6-3
nb.cells.append(new_markdown_cell("""
### سوال 3: پهنای باند FSK
سیگنال FSK با فرکانس‌های 10 MHz و 10.4 MHz داده شده است. اگر نرخ داده 200 kbps باشد، پهنای باند را محاسبه کنید.

**پاسخ:**  
- پهنای باند: \\(BW = |10.4 - 10| + 2 \\times 0.2 = 0.4 + 0.4 = 0.8 \\text{ MHz}\\)
"""))

# سوال 6-4
nb.cells.append(new_markdown_cell("""
### سوال 4: احتمال خطا در BPSK
در سیستم BPSK با \\(E_b/N_0 = 9 \\text{ dB}\\)، احتمال خطای بیت را محاسبه کنید.

**پاسخ:**  
- \\(P_e = Q(\\sqrt{2 \\times 7.94}) \\approx Q(3.98) \\approx 3.4 \\times 10^{-5}\\)
"""))

# سوال 6-5
nb.cells.append(new_markdown_cell("""
### سوال 5: محاسبات QPSK
اگر در QPSK نرخ داده 6 Mbps باشد، نرخ سمبل و پهنای باند چقدر است؟

**پاسخ:**  
- نرخ سمبل: \\(R_s = 6 / 2 = 3 \\text{ مگا سمبل/ثانیه}\\)  
- پهنای باند: \\(BW = 3 \\text{ MHz}\\)
"""))

# سری 7
nb.cells.append(new_markdown_cell("## سری 7: مسائل ترکیبی"))

# سوال 7-1
nb.cells.append(new_markdown_cell("""
### سوال 1: تشخیص نوع مدولاسیون
سیگنال زیر داده شده است. نوع مدولاسیون و پارامترهای آن را مشخص کنید:
\\[
s(t) = 5\\cos(2\\pi 1.01 \\times 10^6 t) - 5\\cos(2\\pi 0.99 \\times 10^6 t)
\\]

**پاسخ:**  
- نوع: DSB-SC  
- فرکانس حامل: 1 MHz  
- سیگنال پیام: \\(m(t) = 5\\sin(2\\pi 0.01 \\times 10^6 t)\\)
"""))

# سوال 7-2
nb.cells.append(new_markdown_cell("""
### سوال 2: محاسبه پهنای باند OFDM
در سیستم OFDM با 52 زیرحامل فعال و فاصله 15 kHz، پهنای باند مؤثر چقدر است؟

**پاسخ:**  
- پهنای باند: \\(52 \\times 15 = 780 \\text{ kHz}\\)
"""))

# سوال 7-3
nb.cells.append(new_markdown_cell("""
### سوال 3: محاسبه ضریب مدولاسیون
اگر در مدولاسیون AM بازده توان 15% باشد، ضریب مدولاسیون چقدر است؟

**پاسخ:**  
- \\(\\mu = \\sqrt{\\frac{2 \\times 0.15}{1 - 0.15}} \\approx 0.59\\)
"""))

# ذخیره فایل
with open('سوالات_مخابراتی_پیشرفته.ipynb', 'w', encoding='utf-8') as f:
    nbf.write(nb, f)

print("فایل Jupyter Notebook با موفقیت ایجاد شد!")
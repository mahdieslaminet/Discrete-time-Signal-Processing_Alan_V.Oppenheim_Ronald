import nbformat as nbf
from nbformat.v4 import new_markdown_cell, new_notebook

# ایجاد نوت‌بوک جدید
nb = new_notebook()

# افزودن عنوان اصلی
nb.cells.append(new_markdown_cell("""
# سوالات تحلیلی و محاسباتی مخابرات
**سری 15 تا 20 - اثبات‌ها و محاسبات پیشرفته در سیستم‌های مخابراتی**
"""))

# سری 15
nb.cells.append(new_markdown_cell("## سری 15: اثبات‌های مدولاسیون آنالوگ"))

# سوال 15-1
nb.cells.append(new_markdown_cell("""
### سوال 1: محدودیت ضریب مدولاسیون در AM
برای سیگنال AM با معادله‌ی زیر، اثبات کنید که ضریب مدولاسیون نمی‌تواند از 1 بیشتر شود:
\\[
s(t) = A_c[1 + \mu \cos(2\pi f_m t)]\cos(2\pi f_c t)
\\]

**اثبات:**  
اگر \\(\\mu > 1\\)، عبارت \\(1 + \mu \cos(2\pi f_m t)\\) می‌تواند منفی شود و باعث قطع شدن پوش سیگنال گردد که در demodulation خطا ایجاد می‌کند.
"""))

# سوال 15-2
nb.cells.append(new_markdown_cell("""
### سوال 2: پهنای باند DSB-SC
اثبات کنید که پهنای باند سیگنال DSB-SC دو برابر فرکانس سیگنال پیام است.

**اثبات:**  
سیگنال DSB-SC به صورت \\(s(t) = A_c m(t)\cos(2\pi f_c t)\\) است. اگر \\(m(t)\\) دارای پهنای باند \\(B\\) باشد، سیگنال مدوله‌شده در محدوده \\(f_c \pm B\\) قرار می‌گیرد. بنابراین، پهنای باند کل \\(2B\\) است.
"""))

# سوال 15-3
nb.cells.append(new_markdown_cell("""
### سوال 3: انحراف فرکانسی در FM
برای سیگنال FM با \\(m(t) = A_m \cos(2\pi f_m t)\\)، اثبات کنید که انحراف فرکانسی \\(\\Delta f = k_f A_m\\).

**اثبات:**  
فرکانس لحظه‌ای سیگنال FM:
\\[
f(t) = f_c + k_f m(t) = f_c + k_f A_m \cos(2\pi f_m t)
\\]
انحراف فرکانسی حداکثر وقتی رخ می‌دهد که \\(\\cos(2\pi f_m t) = 1\\)، بنابراین \\(\\Delta f = k_f A_m\\).
"""))

# سوال 15-4
nb.cells.append(new_markdown_cell("""
### سوال 4: توان سیگنال FM
محاسبه کنید که چرا در مدولاسیون FM، توان سیگنال مستقل از پیام است.

**اثبات:**  
توان سیگنال FM:
\\[
P = \\frac{A_c^2}{2}
\\]
که فقط به دامنه حامل بستگی دارد و مستقل از \\(m(t)\\) است.
"""))

# سوال 15-5
nb.cells.append(new_markdown_cell("""
### سوال 5: محاسبه توان در AM
اگر در مدولاسیون AM، توان حامل 50 وات و ضریب مدولاسیون 0.6 باشد، توان کل را محاسبه کنید.

**محاسبه:**  
\\[
P_{total} = P_c \\left(1 + \\frac{\\mu^2}{2}\\right) = 50 \\left(1 + \\frac{0.36}{2}\\right) = 59 \\text{ وات}
\\]
"""))

# سری 16
nb.cells.append(new_markdown_cell("## سری 16: محاسبات سیستم‌های دیجیتال"))

# سوال 16-1
nb.cells.append(new_markdown_cell("""
### سوال 1: فاز در BPSK
برای سیگنال BPSK با \\(s(t) = A_c \cos(2\pi f_c t + \phi_i)\\)، \\(\\phi_i\\) را برای بیت‌های 0 و 1 مشخص کنید.

**پاسخ:**  
- بیت 0: \\(\\phi_i = 0^\\circ\\)  
- بیت 1: \\(\\phi_i = 180^\\circ\\)
"""))

# سوال 16-2
nb.cells.append(new_markdown_cell("""
### سوال 2: نرخ داده در QPSK
نرخ داده در QPSK با نرخ سمبل 1 مگا سمبل بر ثانیه چقدر است؟

**محاسبه:**  
\\[
R_b = R_s \\times \\log_2(4) = 1 \\times 2 = 2 \\text{ Mbps}
\\]
"""))

# سوال 16-3
nb.cells.append(new_markdown_cell("""
### سوال 3: پهنای باند FSK
پهنای باند سیگنال FSK با فرکانس‌های \\(f_1 = 10\\) MHz و \\(f_2 = 10.4\\) MHz چقدر است؟

**محاسبه:**  
\\[
BW = |f_2 - f_1| + 2R_b = 0.4 \\text{ MHz} + 2R_b
\\]
(اگر \\(R_b\\) داده نشده، حداقل پهنای باند \\(0.4\\) MHz است.)
"""))

# سوال 16-4
nb.cells.append(new_markdown_cell("""
### سوال 4: احتمال خطا در BPSK
احتمال خطای بیت در BPSK با \\(E_b/N_0 = 7\\) dB را محاسبه کنید.

**محاسبه:**  
\\[
P_e = Q\\left(\\sqrt{2 \\times 10^{0.7}}\\right) \\approx Q(3.16) \\approx 0.0008
\\]
"""))

# سوال 16-5
nb.cells.append(new_markdown_cell("""
### سوال 5: توان در 16-QAM
در 16-QAM، اگر فاصله‌ی بین نقاط مجاور 2 ولت باشد، توان میانگین را محاسبه کنید.

**محاسبه:**  
\\[
P_{avg} = \\frac{(A_1^2 + A_2^2 + \\dots + A_{16}^2)}{16} \\times \\frac{1}{2}
\\]
(با فرض نقاط مستطیلی، \\(P_{avg} = 10\\) وات.)
"""))

# سری 17
nb.cells.append(new_markdown_cell("## سری 17: محاسبات کاربردی"))

# سوال 17-1
nb.cells.append(new_markdown_cell("""
### سوال 1: ضریب مدولاسیون AM
اگر در مدولاسیون AM، \\(A_c = 10\\) ولت و \\(A_m = 3\\) ولت باشد، ضریب مدولاسیون چقدر است؟

**محاسبه:**  
\\[
\\mu = \\frac{A_m}{A_c} = \\frac{3}{10} = 0.3
\\]
"""))

# سوال 17-2
nb.cells.append(new_markdown_cell("""
### سوال 2: پارامترهای FM
در FM، اگر \\(k_f = 25\\) kHz/V و \\(m(t) = 2 \\cos(2\\pi 1 \\text{ kHz} t)\\)، \\(\\Delta f\\) و \\(\\beta\\) را محاسبه کنید.

**محاسبه:**  
\\[
\\Delta f = k_f A_m = 25 \\times 2 = 50 \\text{ kHz}, \\quad \\beta = \\frac{\\Delta f}{f_m} = \\frac{50}{1} = 50
\\]
"""))

# سوال 17-3
nb.cells.append(new_markdown_cell("""
### سوال 3: نرخ سمبل QPSK
اگر در QPSK نرخ داده 6 Mbps باشد، نرخ سمبل چقدر است؟

**محاسبه:**  
\\[
R_s = \\frac{R_b}{\\log_2(4)} = \\frac{6}{2} = 3 \\text{ مگا سمبل/ثانیه}
\\]
"""))

# سوال 17-4
nb.cells.append(new_markdown_cell("""
### سوال 4: پهنای باند OFDM
پهنای باند سیگنال OFDM با 64 زیرحامل و فاصله‌ی 15 kHz چقدر است؟

**محاسبه:**  
\\[
BW = N \\times \\Delta f = 64 \\times 15 = 960 \\text{ kHz}
\\]
"""))

# سوال 17-5
nb.cells.append(new_markdown_cell("""
### سوال 5: پهنای باند FSK
در سیستم FSK، اگر \\(f_1 = 902\\) MHz و \\(f_2 = 908\\) MHz باشد، حداقل پهنای باند چقدر است؟

**محاسبه:**  
\\[
BW = |f_2 - f_1| + 2R_b = 6 \\text{ MHz} + 2R_b
\\]
"""))

# ذخیره فایل
with open('سوالات_تحلیلی_مخابرات.ipynb', 'w', encoding='utf-8') as f:
    nbf.write(nb, f)

print("فایل Jupyter Notebook با موفقیت ایجاد شد!")
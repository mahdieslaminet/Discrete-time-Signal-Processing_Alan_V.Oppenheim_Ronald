import nbformat as nbf
from nbformat.v4 import new_markdown_cell, new_notebook

# ایجاد نوت‌بوک جدید
nb = new_notebook()

# افزودن عنوان اصلی
nb.cells.append(new_markdown_cell("""
# سوالات و پاسخ‌های مخابراتی
**موضوعات پوشش داده شده:**  
- مدولاسیون آنالوگ (AM, FM, DSB-SC)  
- مدولاسیون دیجیتال (BPSK, QPSK, FSK, QAM)  
- محاسبات پهنای باند و نرخ داده
"""))

# سری 1: مدولاسیون آنالوگ
nb.cells.append(new_markdown_cell("## سری 1: مدولاسیون آنالوگ (محاسباتی)"))

# سوال 1-1
nb.cells.append(new_markdown_cell("""
### سوال 1
سیگنال پیام \\( m(t) = 2\\cos(2\\pi 1000 t) \\) با حامل \\( c(t) = 10\\cos(2\\pi 10^6 t) \\) مدوله AM می‌شود. اگر ضریب مدولاسیون \\( \\mu = 0.8 \\) باشد، معادله سیگنال مدوله‌شده AM را بنویسید.

**پاسخ:**  
\\[
s(t) = A_c[1 + \\mu m(t)]\\cos(2\\pi f_c t) = 10[1 + 0.8 \\times 2\\cos(2\\pi 1000 t)]\\cos(2\\pi 10^6 t)
\\]  
\\[
s(t) = 10[1 + 1.6\\cos(2\\pi 1000 t)]\\cos(2\\pi 10^6 t)
\\]
"""))

# سوال 1-2
nb.cells.append(new_markdown_cell("""
### سوال 2
در یک سیستم FM، اگر سیگنال پیام \\( m(t) = 3\\sin(2\\pi 2000 t) \\) باشد و حساسیت فرکانسی \\( k_f = 10^4 \\) Hz/V، انحراف فرکانسی (\\( \\Delta f \\)) و شاخص مدولاسیون (\\( \\beta \\)) را محاسبه کنید.

**پاسخ:**  
\\[
\\Delta f = k_f \\cdot \\max|m(t)| = 10^4 \\times 3 = 30 \\text{ kHz}
\\]  
\\[
\\beta = \\frac{\\Delta f}{f_m} = \\frac{30 \\times 10^3}{2000} = 15
\\]
"""))

# سوال 1-3
nb.cells.append(new_markdown_cell("""
### سوال 3
سیگنال DSB-SC با معادله \\( s(t) = 5\\cos(2\\pi 200 t)\\cos(2\\pi 10^6 t) \\) داده شده است. فرکانس حامل و سیگنال پیام را مشخص کنید.

**پاسخ:**  
- فرکانس حامل (\\( f_c \\)): \\( 10^6 \\) Hz  
- سیگنال پیام (\\( m(t) \\)): \\( 5\\cos(2\\pi 200 t) \\) → فرکانس پیام (\\( f_m \\)): 200 Hz
"""))

# سوال 1-4
nb.cells.append(new_markdown_cell("""
### سوال 4
پهنای باند سیگنال FM با \\( \\beta = 5 \\) و فرکانس پیام \\( f_m = 1 \\) kHz چقدر است؟ (از قاعده کارسون استفاده کنید.)

**پاسخ:**  
\\[
BW = 2(\\Delta f + f_m) = 2(\\beta f_m + f_m) = 2(5 \\times 1 + 1) = 12 \\text{ kHz}
\\]
"""))

# سوال 1-5
nb.cells.append(new_markdown_cell("""
### سوال 5
اگر در مدولاسیون AM، توان حامل 50 وات و ضریب مدولاسیون \\( \\mu = 0.6 \\) باشد، توان کل سیگنال AM را محاسبه کنید.

**پاسخ:**  
\\[
P_{total} = P_c \\left(1 + \\frac{\\mu^2}{2}\\right) = 50 \\left(1 + \\frac{0.6^2}{2}\\right) = 50 \\times 1.18 = 59 \\text{ وات}
\\]
"""))

# سری 2: مدولاسیون دیجیتال
nb.cells.append(new_markdown_cell("## سری 2: مدولاسیون دیجیتال (محاسباتی)"))

# سوال 2-1
nb.cells.append(new_markdown_cell("""
### سوال 1
نرخ داده در یک سیستم BPSK با نرخ سمبل 1 مگا سمبل بر ثانیه چقدر است؟

**پاسخ:**  
در BPSK هر سمبل 1 بیت را حمل می‌کند، بنابراین:  
\\[
R_b = R_s = 1 \\text{ Mbps}
\\]
"""))

# سوال 2-2
nb.cells.append(new_markdown_cell("""
### سوال 2
اگر در مدولاسیون QPSK، نرخ سمبل \\( R_s = 500 \\) کیلو سمبل بر ثانیه باشد، نرخ داده (\\( R_b \\)) چقدر است؟

**پاسخ:**  
در QPSK هر سمبل 2 بیت را حمل می‌کند، بنابراین:  
\\[
R_b = R_s \\times 2 = 500 \\times 2 = 1 \\text{ Mbps}
\\]
"""))

# سوال 2-3
nb.cells.append(new_markdown_cell("""
### سوال 3
سیگنال FSK با فرکانس‌های \\( f_1 = 10 \\) MHz و \\( f_2 = 10.5 \\) MHz داده شده است. اگر نرخ داده 500 کیلوبیت بر ثانیه باشد، فاصله فرکانسی (\\( \\Delta f \\)) و پهنای باند تقریبی را محاسبه کنید.

**پاسخ:**  
- فاصله فرکانسی:  
  \\[
  \\Delta f = f_2 - f_1 = 0.5 \\text{ MHz}
  \\]  
- پهنای باند (طبق قاعده کارسون):  
  \\[
  BW = 2\\Delta f + 2R_b = 2 \\times 0.5 \\text{ MHz} + 2 \\times 500 \\text{ kHz} = 1 \\text{ MHz} + 1 \\text{ MHz} = 2 \\text{ MHz}
  \\]
"""))

# سوال 2-4
nb.cells.append(new_markdown_cell("""
### سوال 4
در یک سیستم PSK، اگر فازهای مورد استفاده \\( 0^\\circ, 90^\\circ, 180^\\circ, 270^\\circ \\) باشند، هر سمبل چند بیت را نمایش می‌دهد؟

**پاسخ:**  
از آنجا که 4 فاز مجزا داریم، هر سمبل \\( \\log_2(4) = 2 \\) بیت را نمایش می‌دهد.
"""))

# سوال 2-5
nb.cells.append(new_markdown_cell("""
### سوال 5
اگر در مدولاسیون 16-QAM، نرخ سمبل \\( R_s = 1 \\) مگا سمبل بر ثانیه باشد، نرخ داده چقدر است؟

**پاسخ:**  
در 16-QAM هر سمبل \\( \\log_2(16) = 4 \\) بیت را حمل می‌کند، بنابراین:  
\\[
R_b = R_s \\times 4 = 1 \\times 4 = 4 \\text{ Mbps}
\\]
"""))

# سری 3: ترکیبی
nb.cells.append(new_markdown_cell("## سری 3: ترکیبی (مسائل پیچیده‌تر)"))

# سوال 3-1
nb.cells.append(new_markdown_cell("""
### سوال 1
سیگنال \\( s(t) = 2\\cos(2\\pi 10^6 t) + \\cos(2\\pi 1.1 \\times 10^6 t) + \\cos(2\\pi 0.9 \\times 10^6 t) \\) داده شده است. آیا این سیگنال می‌تواند یک سیگنال AM باشد؟ اگر بله، \\( m(t) \\) و \\( \\mu \\) را محاسبه کنید.

**پاسخ:**  
بله، این سیگنال AM است با باندهای جانبی در \\( 1.1 \\) MHz و \\( 0.9 \\) MHz.  
- فرکانس پیام (\\( f_m \\)): \\( 1.1 - 1 = 0.1 \\) MHz  
- معادله AM:  
  \\[
  s(t) = 2\\left[1 + \\mu \\cos(2\\pi 0.1 \\times 10^6 t)\\right]\\cos(2\\pi 10^6 t)
  \\]  
  با مقایسه با سیگنال داده شده:  
  \\[
  2\\mu = 1 \\Rightarrow \\mu = 0.5
  \\]  
  \\[
  m(t) = \\cos(2\\pi 0.1 \\times 10^6 t)
  \\]
"""))

# سوال 3-2
nb.cells.append(new_markdown_cell("""
### سوال 2
در یک سیستم FM، اگر \\( \\Delta f = 75 \\) kHz و \\( f_m = 15 \\) kHz باشد، پهنای باند را با دو روش کارسون و قاعده \\( BW = 2(\\beta + 1)f_m \\) محاسبه و مقایسه کنید.

**پاسخ:**  
- شاخص مدولاسیون (\\( \\beta \\)):  
  \\[
  \\beta = \\frac{\\Delta f}{f_m} = \\frac{75}{15} = 5
  \\]  
- قاعده کارسون:  
  \\[
  BW = 2(\\Delta f + f_m) = 2(75 + 15) = 180 \\text{ kHz}
  \\]  
- قاعده دوم:  
  \\[
  BW = 2(\\beta + 1)f_m = 2(5 + 1)15 = 180 \\text{ kHz}
  \\]  
  نتیجه یکسان است!
"""))

# سوال 3-3
nb.cells.append(new_markdown_cell("""
### سوال 3
اگر در یک سیستم دیجیتال، نرخ خطای بیت (BER) \\( 10^{-4} \\) باشد و نرخ داده 1 Mbps، میانگین تعداد بیت‌های اشتباه در هر ثانیه چقدر است؟

**پاسخ:**  
\\[
\\text{تعداد بیت‌های اشتباه} = \\text{BER} \\times R_b = 10^{-4} \\times 10^6 = 100 \\text{ بیت/ثانیه}
\\]
"""))

# سوال 3-4
nb.cells.append(new_markdown_cell("""
### سوال 4
سیگنال \\( s(t) = 4\\cos(2\\pi 10^6 t) + 2\\cos(2\\pi 1.02 \\times 10^6 t) - 2\\cos(2\\pi 0.98 \\times 10^6 t) \\) داده شده است. نوع مدولاسیون و پارامترهای آن را مشخص کنید.

**پاسخ:**  
این سیگنال یک **سیگنال SSB** (با باند جانبی پایین) است، زیرا باند جانبی بالا حذف شده است.  
- فرکانس حامل (\\( f_c \\)): 1 MHz  
- فرکانس پیام (\\( f_m \\)): \\( 1.02 - 1 = 0.02 \\) MHz  
- دامنه پیام: 2 (از جمله فاز منفی).
"""))

# سوال 3-5
nb.cells.append(new_markdown_cell("""
### سوال 5
در مدولاسیون 8-PSK، اگر نرخ سمبل 600 کیلو سمبل بر ثانیه باشد، پهنای باند حداقل چقدر است؟

**پاسخ:**  
پهنای باند حداقل برابر با نرخ سمبل است (با فرض فیلتر ایده‌آل):  
\\[
BW = R_s = 600 \\text{ kHz}
\\]
"""))

# ذخیره فایل
with open('سوالات_مخابراتی.ipynb', 'w', encoding='utf-8') as f:
    nbf.write(nb, f)

print("فایل Jupyter Notebook با موفقیت ایجاد شد!")